name: ğŸš€ Keep Portfolio Alive

on:
  schedule:
    # Ping cada 10 minutos para mantener activo
    - cron: '*/10 * * * *'
  workflow_dispatch:
    # Permite ejecutar manualmente

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ”„ Ping Portfolio
        run: |
          echo "ğŸŒ Haciendo ping al portfolio..."
          
          # Ping principal
          response=$(curl -s -o /dev/null -w "%{http_code}" https://fernando-olvera-portfolio.onrender.com)
          
          if [ $response -eq 200 ]; then
            echo "âœ… Portfolio activo - Status: $response"
            echo "â° Timestamp: $(date)"
          else
            echo "âš ï¸ Status code: $response"
            # Reintentar despuÃ©s de 30 segundos
            sleep 30
            response2=$(curl -s -o /dev/null -w "%{http_code}" https://fernando-olvera-portfolio.onrender.com)
            echo "ğŸ”„ Segundo intento - Status: $response2"
          fi
          
          # Ping adicional a pÃ¡ginas importantes
          echo "ğŸ“„ Verificando pÃ¡ginas principales..."
          curl -s -I https://fernando-olvera-portfolio.onrender.com/cv-fernando-olvera.pdf
          
          echo "ğŸ¯ Keep-alive completado exitosamente"

      - name: ğŸ“Š Portfolio Health Check
        run: |
          echo "ğŸ” Verificando salud del portfolio..."
          
          # Verificar tiempo de respuesta
          response_time=$(curl -s -o /dev/null -w "%{time_total}" https://fernando-olvera-portfolio.onrender.com)
          echo "âš¡ Tiempo de respuesta: ${response_time}s"
          
          # Verificar que el contenido principal estÃ© disponible
          content_check=$(curl -s https://fernando-olvera-portfolio.onrender.com | grep -c "Fernando Olvera" || echo "0")
          
          if [ $content_check -gt 0 ]; then
            echo "âœ… Contenido verificado correctamente"
          else
            echo "âš ï¸ Problema detectado en el contenido"
          fi
          
          echo "ğŸ“ˆ Health check completado"